function fcn_unsetOauth(t){const e=prompt(t.dataset.warning);if(!e||e.toLowerCase()!=t.dataset.confirm.toLowerCase())return;const n=_$$$(`oauth-${t.dataset.channel}`);n.classList.add("ajax-in-progress"),FcnUtils.aPost(payload={action:"fictioneer_ajax_unset_my_oauth",nonce:t.dataset.nonce,channel:t.dataset.channel,id:t.dataset.id}).then((t=>{t.success?(n.classList.remove("_connected"),n.classList.add("_disconnected"),n.querySelector("button").remove(),fcn_showNotification(n.dataset.unset)):(n.style.background="var(--notice-warning-background)",fcn_showNotification(t.data.failure??t.data.error??fictioneer_tl.notification.error,5,"warning"),(t.data.error||t.data.failure)&&console.error("Error:",t.data.error??t.data.failure))})).catch((t=>{t.status&&t.statusText&&(n.style.background="var(--notice-warning-background)",fcn_showNotification(`${t.status}: ${t.statusText}`,5,"warning")),console.error(t)})).then((()=>{n.classList.remove("ajax-in-progress")}))}function fcn_deleteMyAccount(t){if(_$$$("button-delete-my-account").hasAttribute("disabled"))return;const e=prompt(t.dataset.warning);e&&e.toLowerCase()==t.dataset.confirm.toLowerCase()&&(_$$$("button-delete-my-account").setAttribute("disabled",!0),FcnUtils.aPost({action:"fictioneer_ajax_delete_my_account",nonce:t.dataset.nonce,id:t.dataset.id}).then((t=>{t.success?location.reload():(_$$$("button-delete-my-account").innerHTML=t.data.button,fcn_showNotification(t.data.failure??t.data.error??fictioneer_tl.notification.error,5,"warning"),(t.data.error||t.data.failure)&&console.error("Error:",t.data.error??t.data.failure))})).catch((t=>{t.status&&t.statusText&&(fcn_showNotification(`${t.status}: ${t.statusText}`,5,"warning"),_$$$("button-delete-my-account").innerHTML=response.data.button),console.error(t)})))}_$$(".button-unset-oauth").forEach((t=>{t.addEventListener("click",(t=>{fcn_unsetOauth(t.currentTarget)}))})),_$$$("button-delete-my-account")?.addEventListener("click",(t=>{fcn_deleteMyAccount(t.currentTarget)}));const fcn_profileDataTranslations=_$$$("profile-data-translations")?.dataset;function fcn_dataDeletionPrompt(t){const e=prompt(t.dataset.warning);return!(!e||e.toLowerCase()!=t.dataset.confirm.toLowerCase())}function fcn_clearData(t,e){const n=t.closest(".card");localStorage.removeItem("fcnBookshelfContent"),t.remove(),FcnUtils.remoteAction(e,{nonce:t.dataset.nonce,element:n,callback:(t,e)=>{t.success&&e&&(e.querySelector(".card__content").innerHTML=t.data.success)}})}_$(".button-clear-comments")?.addEventListener("click",(t=>{fcn_dataDeletionPrompt(t.currentTarget)&&fcn_clearData(t.currentTarget,"fictioneer_ajax_clear_my_comments")})),_$(".button-clear-comment-subscriptions")?.addEventListener("click",(t=>{fcn_dataDeletionPrompt(t.currentTarget)&&fcn_clearData(t.currentTarget,"fictioneer_ajax_clear_my_comment_subscriptions")})),_$(".button-clear-checkmarks")?.addEventListener("click",(t=>{if(fcn_dataDeletionPrompt(t.currentTarget)){const e=window.FictioneerApp.Controllers.fictioneerCheckmarks;if(!e)return void fcn_showNotification("Error: Checkmarks Controller not connected.",3,"warning");e.clear(),fcn_clearData(t.currentTarget,"fictioneer_ajax_clear_my_checkmarks",!0)}})),_$(".button-clear-reminders")?.addEventListener("click",(t=>{if(fcn_dataDeletionPrompt(t.currentTarget)){const e=window.FictioneerApp.Controllers.fictioneerReminders;if(!e)return void fcn_showNotification("Error: Reminders Controller not connected.",3,"warning");e.clear(),fcn_clearData(t.currentTarget,"fictioneer_ajax_clear_my_reminders",!0)}})),_$(".button-clear-follows")?.addEventListener("click",(t=>{if(fcn_dataDeletionPrompt(t.currentTarget)){const e=window.FictioneerApp.Controllers.fictioneerFollows;if(!e)return void fcn_showNotification("Error: Follows Controller not connected.",3,"warning");e.clear(),fcn_clearData(t.currentTarget,"fictioneer_ajax_clear_my_follows",!0)}})),_$(".button-clear-bookmarks")?.addEventListener("click",(t=>{if(fcn_dataDeletionPrompt(t.currentTarget)){const e=window.FictioneerApp.Controllers.fictioneerBookmarks;if(!e)return void fcn_showNotification("Error: Bookmarks Controller not connected.",3,"warning");e.clear(),t.currentTarget.closest(".card").querySelector(".card__content").innerHTML=fcn_profileDataTranslations.clearedSuccess}}));